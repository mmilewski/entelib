{% extends 'base_with_top_menu.html' %}

{% load go_back_link %}

{% block title %}{{ book.title }}{% endblock %}

{% block header %}Book copies{% endblock %}

{% block content %}
    <h2>Title: {{ book.title }}</h2>

    <div class="book_authors">
        <dt>Authors:</dt>
        {% if book.authors %}
        <dd>{{ book.authors|join:', '}}</dd>
        {% else %}
        <dd>No authors.</dd>
        {% endif %}
    </div>

    <div class="book_categories">
      <dt>Categories:</dt>
      {% if book.categories %}
      <dd>{{ book.categories|join:", " }}</dd>
      {% else %}
      <dd>This book wasn't assigned to any category.</dd>
      {% endif %}
    </div>

    <div class='content_form'>
        <form action='.' method='post'>
            <table>
                <tr>
                    <td>Location: </td>
                    <td>
                        <select name='location' multiple='multiple' size='{{ search.copies_select_size }}'>
                            {% for location in search.locations %}
                                <option value='{{ location.id }}' {% if location.selected %}selected{% endif %}>{{ location.name }}</option>
                            {% endfor %}
                        </select>
                    </td>
                </tr><tr>
                    <td>Only available: </td>
                    <td>
                        <input type='checkbox' name='available' value='available' {% if only_available_checked %} checked='checked' {% endif %} >
                    </td>
                </tr><tr>
                    <td></td><td>
                        <input type='submit'  name='action' value='Search'>
                    </td></tr>
            </table>
        </form>
    </div>

    <div class="bookcopy_actions">
      {% if can_add_bookcopy %}
      <a href="/entelib/admin/baseapp/bookcopy/add/?book={{book.id}}" class="add_bookcopy">Add book copy.</a>
      {% endif %}
    </div>

    {% comment %}
    If no argument is specified, then default one will be loaded - which is set in Config.
    Try typing:
    {% go_back_link %}
    {% endcomment %}
    {% go_back_link "Go back" %}

    <div class="book_copies">
      <h3 id="book_copies">Copies of this book:</h3>
        <!-- <ul class='booklist'>
        {% for item in book.items %}
        <li><b><a href='{{ item.url }}'>>></a></b>:
            <ul>
            <li>Location: {{ item.location }}</li>
            <li>State: {{ item.state }}</li>
            <li>Publisher: {{ item.publisher }}</li>
            <li>Year: {{ item.year }}</li>
            <li><a href='{{ item.desc_url}}'>External description</a> </li>
            <li><a href='{{ item.reserve_url }}'>Reserve</a></li>
            </ul>
        </li>
        {% empty %}
        <b>Sorry, no copies.</b>
        {% endfor %}
        </ul> -->
        {% if book.items %}
            <table class='booklist'>
                <tr>
                    <th></th>
                    <th>Location</th>
                    <th>State</th>
                    <th>Publisher</th>
                    <th>Year</th>
                    <th>Actions</th>
                </tr>
                {% for item in book.items %}
                    <tr>
                        <td class="url"><a href='{{ item.url }}'>>></a></td>
                        <td class="location">{{ item.location }}</td>
                        <td class="state">{{ item.state }} {% if not item.is_available %}<span style="color:red;" title="Unavailable, sorry">(not avail)</span>{%endif%}</td>
                        <td class="publisher">{{ item.publisher }}</td>
                        <td class="year">{{ item.year }}</td>
                        <td class="actions">
                            <ul class="actions">
                                <!-- <li><a href='{{ item.desc_url}}'>External description</a></li> -->
                                <li><a href="{{ item.url }}#description">Description</a></li>
                                {%if item.is_reservable %}<li><a href='{{ item.reserve_url }}'
                                                                 {% if not item.is_available %}class="available" title="Book is not available"{% endif %}>
                                                                 Reserve
                                                              </a></li> {% endif %}
                            </ul>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <br><b>No copies.</b>
        {% endif %}
    </div>
    {% go_back_link "Go back" %}

{% endblock %}
